Fetch all the order items that are in the created status and the order type should be a sales order
- ORDER_ID
- PRODUCT_TYPE_ID
- ORDER_LINE_ID	
- EXTERNAL_ID
- SALES_CHANNEL
- QUANTITY
- ITEM_STATUS 
- PRODUCT_ID
- BILL_CITY
- BILL_COUNTRY
- BILL_POSTALCODE	
- BILL_ADDRESS1
- BILL_ADDRESS2
- SHIP_CITY
- SHIP_COUNTRY
- SHIP_POSTALCODE
- SHIP_ADDRESS1
- SHIP_ADDRESS2

**Solution â€“** 
```sql
select
	oi.ORDER_ID,
	p.PRODUCT_TYPE_ID,
	oi.ORDER_ITEM_SEQ_ID,
	oh.EXTERNAL_ID,
	oh.SALES_CHANNEL_ENUM_ID,
	oi.QUANTITY,
	oi.STATUS_ID as ITEM_STATUS,
	oi.PRODUCT_ID,
	pb.CITY as BILL_CITY,
	pb.COUNTRY_GEO_ID as BILL_COUNTRY,
	pb.POSTAL_CODE as BILL_POSTALCODE,
	pb.ADDRESS1 as BILL_ADDRESS1,
	pb.ADDRESS2 as BILL_ADDRESS2,
	ps.CITY as SHIP_CITY,
	ps.COUNTRY_GEO_ID as SHIP_COUNTRY,
	ps.POSTAL_CODE as SHIP_POSTALCODE,
	ps.ADDRESS1 as SHIP_ADDRESS1,
	ps.ADDRESS2 as SHIP_ADDRESS2
from
	order_item oi
join product p on
	oi.PRODUCT_ID = p.PRODUCT_ID
join order_status os on
	oi.ORDER_ID = os.ORDER_ID
	and oi.ORDER_ITEM_SEQ_ID = os.ORDER_ITEM_SEQ_ID
	and os.STATUS_ID = oi.STATUS_ID
join order_header oh on
	oi.ORDER_ID = oh.ORDER_ID
join order_contact_mech ocm on
	oi.ORDER_ID = ocm.ORDER_ID
	and (ocm.CONTACT_MECH_PURPOSE_TYPE_ID = 'BILLING_LOCATION'
		or ocm.CONTACT_MECH_PURPOSE_TYPE_ID = 'SHIPPING_LOCATION'
  )
left join postal_address pb on
	ocm.CONTACT_MECH_ID = pb.CONTACT_MECH_ID
	and ocm.CONTACT_MECH_PURPOSE_TYPE_ID = 'BILLING_LOCATION'
left join postal_address ps on
	ocm.CONTACT_MECH_ID = ps.CONTACT_MECH_ID
	and ocm.CONTACT_MECH_PURPOSE_TYPE_ID = 'SHIPPING_LOCATION'
where
	os.STATUS_ID = 'ITEM_CREATED'
	and oh.ORDER_TYPE_ID = 'SALES_ORDER';
```

**Execution Plan**
COST - 58,300.14
